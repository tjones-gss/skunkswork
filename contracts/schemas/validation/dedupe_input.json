{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://nam-pipeline/contracts/schemas/validation/dedupe_input.json",
  "title": "DedupeInput",
  "description": "Input contract for DedupeAgent",
  "type": "object",
  "properties": {
    "companies": {
      "type": "array",
      "items": { "$ref": "../core/company.json" },
      "minItems": 1,
      "description": "Companies to deduplicate"
    },
    "matching_strategy": {
      "type": "string",
      "enum": ["exact", "fuzzy", "ml"],
      "default": "fuzzy",
      "description": "Matching algorithm to use"
    },
    "match_fields": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["company_name", "domain", "website", "phone", "address"]
      },
      "default": ["company_name", "domain"],
      "description": "Fields to use for matching"
    },
    "fuzzy_threshold": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "default": 0.85,
      "description": "Similarity threshold for fuzzy matching"
    },
    "merge_strategy": {
      "type": "string",
      "enum": ["keep_first", "keep_latest", "merge_all", "keep_highest_quality"],
      "default": "merge_all",
      "description": "How to handle duplicate records"
    },
    "_meta": {
      "type": "object",
      "description": "Pipeline metadata (auto-injected)"
    }
  },
  "required": ["companies"],
  "additionalProperties": false
}
